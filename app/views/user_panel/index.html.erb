<%= render "activity" %>
<%= render "layouts/user-panel" %>

<head>
<style>
.modal { width: 85% !important ; max-height: 80% !important ; }

</style>
</head>

<div class="main">
    
    <div id="floating-panel">
        <button class="btn activation" id="#heatMap_report" onclick="toggleHeatmap()">Mapa de calor</button>
        <button class="btn activation" id="#heatMap_radius" onclick="changeRadius()">Aumentar radio</button>
        <button class="btn activation" id="#heatMap_gradient" onclick="changeGradient()">Cambio de color</button>
    </div>
    <div id="map" class="map_user-panel"></div>
</div>


<!-- Generacion del mapa con todos los reportes hechos -->
<script>
    var xlat, xlng;
    var loc_crime;
    var details;
    var data = [];
    var data_susp = [];
    var data_transp = [];
    var data_security = [];
    var report_url;

    <% @temp.each do | report | %>
          xlat = "<%= report.latitude %>" ;
          xlng = "<%= report.longitude %> ";
          details = "<%= report.details %> ";
          report_url = "<%=report_path(report.id)%>";
          tipo = "<%= report.tipo_transp %>";
          num_ruta = "<%= report.id_route %>";
          xlat = parseFloat(xlat);
          xlng = parseFloat(xlng);
          tuple = [xlat, xlng, details, report_url, tipo, num_ruta];
          data.push(tuple);
    <% end %>

    <% @suspect_temp.each do | suspect | %>
          xlat = "<%= suspect.latitude %>" ;
          xlng = "<%= suspect.longitude %> ";
          details = "<%= suspect.details %> ";
          report_url = "<%=suspect_path(suspect.id)%>";
          xlat = parseFloat(xlat);
          xlng = parseFloat(xlng);
          tuple = [xlat, xlng, details,report_url];
          data_susp.push(tuple);
    <% end %>



    <% @security.each do | security | %>
          xlat = "<%= security.latitude %>" ;
          xlng = "<%= security.longitude %> ";
          details = "<%= security.details %> ";
          report_url = "<%=security_news_path(security.id)%>";
          xlat = parseFloat(xlat);
          xlng = parseFloat(xlng);
          tuple = [xlat, xlng, details,report_url];
          data_security.push(tuple);
    <% end %>

</script>

<!-- Modal Structure -->
<div id="modal1" class="modal">
  <div class="modal-content">
  </div>
</div>

<script>
$(document).ready(function(){
    // the "href" attribute of the modal trigger must specify the modal ID that wants to be triggered
    $('.modal').modal();
  });
</script>

<%= render "layouts/map-actions" %>
<%= javascript_include_tag "g_maps/gm_user-panel" %>

